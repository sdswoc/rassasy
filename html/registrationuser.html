<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
      Rassasy: Registration
    </title>
    <link rel="stylesheet" href="../css/registrationuser.css" />
    <link rel="stylesheet" href="../css/bootstrap.min.css" />
    <script type="text/javascript" src="../JS/jquery-3.4.1.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  </head>
  <body>
    <div class="registration-user-container">
      <div class="header">User Registration</div>
      <div class="body">
        <div><img class="logo" src="/Images/images.jpeg" alt="" /></div>
        <div class="registration">
          <form method="post" action="../php/registeruser.php">
            Name: <input type="text" name="name" required="required" /><br />
            Enrollment No:
            <input type="text" id="enroll" name="enroll" required="required" />
            <br /><label class="error" id="enroll_result"></label>
            <br />

            Username:
            <input
              type="text"
              id="username"
              name="username"
              required="required"
            />
            <br /><label class="error" id="username_result"></label>
            <br />

            Password:
            <input
              type="password"
              name="password"
              id="p"
              required="required"
              onkeyup="pass_check()"
            />
            <br />
            Confirm Password:
            <input
              type="password"
              name="password2"
              id="p2"
              required="required"
              onkeyup="pass_check()"
            />
            <br /><label id="pass"></label> <br />

            Mobile No:
            <input type="text" name="mobile" required="required" /><br />

            Bhawan:
            <select class="bhawan" id="bhawan" required="required">
              <option value="1">one</option>
              <option value="2">two</option>
              <option value="3">three</option>
              <option value="4">four</option>
            </select>
            Room no: <input type="text" name="room" required="required" /><br />
            Email Address:
            <input type="email" name="email" id="email" required="required" />
            <br /><label class="error" id="email_result"></label>
            <br />

            <input type="submit" value="Register" />
          </form>
          <a href="/html/login.html">Already have an account? Login.</a>
        </div>
      </div>
    </div>

    <script>
      $("#enroll").blur(function(event) {
        var enrollinput = $("#enroll").val();

        $.ajax({
          type: "post",
          url: "../php/check_enroll.php",
          data: { enroll: enrollinput },
          dataType: "json",
          success: function(response) {
            if (response == "false") {
              $("#enroll_result").html("Enrollment Number Already Exists");
              event.preventDefault();
              alert("Enrollment Number Already Exists");
            } else if (response == "true") $("#enroll_result").empty();
          }
        });
      });

      $("#username").blur(function(event) {
        var usernameinput = $("#username").val();

        $.ajax({
          type: "post",
          url: "../php/check_username.php",
          data: { username: usernameinput },
          dataType: "json",
          success: function(response) {
            if (response == "false") {
              $("#username_result").html("Username Already Exists");
              event.preventDefault();
              alert("Username Already Exists");
            } else if (response == "true") $("#username_result").empty();
          }
        });
      });

      var check_password = 0;
      function pass_check() {
        var p = document.getElementById("p").value;
        var p2 = document.getElementById("p2").value;
        if (p2) {
          if (p != p2) {
            var msg = "Passwords don't match".fontcolor("red");
            document.getElementById("pass").innerHTML = msg;
            check_password = 0;
          } else {
            var msg = "Passwords match".fontcolor("green");
            document.getElementById("pass").innerHTML = msg;
            check_password = 1;
          }
        }
      }

      $("#email").keyup(function(event) {
        var emailinput = $("#email").val();

        $.ajax({
          type: "post",
          url: "../php/check_email.php",
          data: { email: emailinput },
          success: function(response) {
            if (response == "false") {
              $("#email_result").html("Email Already Exists");
              event.preventDefault();
            } else if (response == "true") $("#email_result").empty();
          }
        });
      });
    </script>
  </body>
</html>
