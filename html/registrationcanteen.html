<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
      Rassasy: Registration
    </title>
    <link rel="stylesheet" href="../css/registrationcanteen.css" />
    <script type="text/javascript" src="../JS/jquery-3.4.1.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  </head>
  <body>
    <div class="registration-canteen-container">
      <div><img class="logo" src="/Images/images.jpeg" alt="" /></div>
      <div class="header">Canteen Registration</div>
      <div class="body">
        <div class="registration">
          <form method="POST" action="/php/registercanteen.php">
            Canteen's Name: <input type="text" name="canteenname" /><br />
            Canteen ID:
            <input
              type="text"
              id="canteenid"
              name="canteenid"
              required="required"
            />
            <br /><label class="error" id="canteenid_result"></label>
            <br />

            Password:
            <input
              type="password"
              name="password"
              id="p"
              required="required"
              onkeyup="pass_check()"
            />
            <br />
            Confirm Password:
            <input
              type="password"
              name="password2"
              id="p2"
              required="required"
              onkeyup="pass_check()"
            />
            <br /><label id="pass"></label> <br />

            Email Address:
            <input
              type="email"
              id="signup_email"
              name="email"
              required="required"
            />
            <br /><label class="error" id="signup_email_result"></label>
            <br />

            Managers Name: <input type="text" name="managername" /><br />
            Mobile No: <input type="text" name="mobile" /><br />
            Location: <input type="text" name="location" /><br />
            Opening Time: <input type="time" name="openingtime" /><br />
            Closing Time: <input type="time" name="closingtime" /><br />
            <input type="submit" value="Register" />
          </form>
          <a href="/html/login.html">Already have an account? Login.</a>
        </div>
      </div>
    </div>
    <script>
      $("#canteenid").blur(function(event) {
        var canteenidinput = $("#canteenid").val();

        $.ajax({
          type: "post",
          url: "../php/check_canteenid.php",
          data: { canteenid: canteenidinput },
          dataType: "json",
          success: function(response) {
            if (!response) {
              $("#canteenid_result").html("canteen ID Already Exists");
              event.preventDefault();
              alert("canteen ID Already Exists");
            } else {
              $("#canteenid_result").empty();
            }
          }
        });
      });
      
      var check_password = 0;
      function pass_check() {
        var p = document.getElementById("p").value;
        var p2 = document.getElementById("p2").value;
        if (p2) {
          if (p != p2) {
            var msg = "Passwords don't match".fontcolor("red");
            document.getElementById("pass").innerHTML = msg;
            check_password = 0;
          } else {
            var msg = "Passwords match".fontcolor("green");
            document.getElementById("pass").innerHTML = msg;
            check_password = 1;
          }
        }
      }

      $("#email").keyup(function(event) {
        var emailinput = $("#email").val();
        var tablename = "canteen";

        $.ajax({
          type: "post",
          url: "../php/check_email.php",
          data: { email: emailinput, tablename: tablename },
          dataType: "json",
          success: function(response) {
            if (!response) {
              $("#email_result").html("Email Already Exists");
              event.preventDefault();
              alert("Email Already Exists");
            } else {
              $("#email_result").empty();
            }
          }
        });
      });
    </script>
  </body>
</html>
